{"version":3,"sources":["webpack:///webpack/bootstrap 90a189ee488685dfc86f","webpack:///external \"express\"","webpack:///external \"multer\"","webpack:///external \"mongoose\"","webpack:///external \"passport\"","webpack:///external \"body-parser\"","webpack:///./src/model/user.js","webpack:///./src/index.js","webpack:///external \"path\"","webpack:///external \"serve-favicon\"","webpack:///external \"volleyball\"","webpack:///external \"express-session\"","webpack:///external \"connect-flash\"","webpack:///./src/routes/index.js","webpack:///./src/routes/story.js","webpack:///./src/model/story.js","webpack:///./src/routes/user.js","webpack:///external \"passport-local\""],"names":["Schema","mongoose","UserSchema","email","type","String","username","index","password","User","model","app","express","use","static","path","join","__dirname","session","secret","resave","saveUninitialized","passport","initialize","serializeUser","user","done","id","deserializeUser","findById","err","upload","multer","dest","port","connect","db","connection","on","console","error","bind","once","log","set","json","urlencoded","extended","flash","req","res","next","locals","listen","start","routes","Router","get","render","title","stories","uploads","Story","find","populate","post","body","auteur","_id","newStory","file","profileimage","filename","save","story","redirect","params","name","findOneandRemove","storySchema","ouvrage","Types","ObjectId","ref","users","LocalStrategy","passportLocal","Strategy","findOne","authenticate","successRedirect","failureRedirect","logout"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 6);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 90a189ee488685dfc86f","module.exports = require(\"express\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express\"\n// module id = 0\n// module chunks = 0","module.exports = require(\"multer\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"multer\"\n// module id = 1\n// module chunks = 0","module.exports = require(\"mongoose\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"mongoose\"\n// module id = 2\n// module chunks = 0","module.exports = require(\"passport\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"passport\"\n// module id = 3\n// module chunks = 0","module.exports = require(\"body-parser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"body-parser\"\n// module id = 4\n// module chunks = 0","import mongoose from 'mongoose'\r\nconst Schema = mongoose.Schema\r\n\r\nconst UserSchema = new Schema({\r\n  email:{type:String},\r\n  username: {type: String, index: true},\r\n  password:{type:String},\r\n})\r\n\r\nconst User = mongoose.model('User', UserSchema)\r\n\r\nexport { User }\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/model/user.js","import express from \"express\"\r\nimport path from \"path\"\r\nimport favicon from \"serve-favicon\"\r\nimport passport from \"passport\"\r\nimport volleyball from \"volleyball\"\r\nimport multer from \"multer\"\r\nimport session from \"express-session\"\r\nimport bodyParser from \"body-parser\"\r\nimport { User } from './model/user'\r\n// config body-parseur\r\n\r\n//\r\nvar app = express()\r\n\r\n//don't work\r\n// app.set('trust proxy', 1) // trust first proxy\r\n// app.use(session({\r\n//   secret: 'keyboard cat',\r\n//   resave: true,\r\n//   saveUninitialized: true,\r\n//   cookie: { secure: true }\r\n// }))\r\n//\r\n//config passport\r\napp.use(express.static(path.join(__dirname, 'public')));\r\napp.use(session({ secret: 'anything', resave:true, saveUninitialized:true }));\r\napp.use(passport.initialize());\r\napp.use(passport.session());\r\n\r\n\r\npassport.serializeUser(function(user, done) {\r\n  done(null, user.id);\r\n});\r\n\r\npassport.deserializeUser(function(id, done) {\r\n  User.findById(id, function(err, user) {\r\n    done(err, user);\r\n  });\r\n});\r\n\r\n//config multer\r\nconst upload = multer({dest:'./uploads'})\r\n//\r\nimport flash from \"connect-flash\"\r\nimport mongoose from \"mongoose\"\r\nconst port = 4567\r\n//config mongo\r\nmongoose.connect('mongodb://localhost/auth_db');\r\nvar db = mongoose.connection;\r\ndb.on('error', console.error.bind(console, 'connection error:'));\r\ndb.once('open', function() {\r\n  console.log('[MONGODB][server ok] ===> connected!')\r\n});\r\n//\r\nimport {routes} from \"./routes/index\"\r\nimport {stories} from \"./routes/story\"\r\nimport {users} from \"./routes/user\"\r\n//view engine setup\r\napp.set(\"views\" ,path.join(__dirname,'views'))\r\napp.set('view engine', 'pug')\r\n//\r\napp.use(volleyball)\r\napp.use(express.json())\r\napp.use(express.urlencoded({extended:false}))\r\n// app.use(bodyParser.urlencoded({extended:false}))\r\napp.use(express.static(path.join(__dirname, 'public')))\r\napp.use(flash())\r\n\r\n//\r\napp.use((req, res, next) => {\r\n  res.locals.user = req.user || null;\r\n  next();\r\n})\r\n\r\n\r\napp.use('/', routes)\r\napp.use('/users', users)\r\napp.use('/stories', stories)\r\n\r\n\r\n\r\napp.listen(port,() =>{\r\n  console.log(`[App running on port : ${port}]`);\r\n})\r\n\r\nconst start =\"server start\"\r\nconsole.log(`${start}`);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","module.exports = require(\"path\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"path\"\n// module id = 8\n// module chunks = 0","module.exports = require(\"serve-favicon\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"serve-favicon\"\n// module id = 9\n// module chunks = 0","module.exports = require(\"volleyball\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"volleyball\"\n// module id = 10\n// module chunks = 0","module.exports = require(\"express-session\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express-session\"\n// module id = 11\n// module chunks = 0","module.exports = require(\"connect-flash\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"connect-flash\"\n// module id = 12\n// module chunks = 0","import express from \"express\"\r\nconst routes = express.Router()\r\n\r\n//get -home page\r\nroutes.get('/', (req, res) =>{\r\n  console.log(req.user)\r\n  res.render(\"index\", {title:\"Accueil\"})\r\n})\r\n\r\nexport { routes }\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/routes/index.js","import express from \"express\"\r\nconst stories = express.Router()\r\nimport { Story } from '../model/story'\r\nimport multer from 'multer'\r\nconst uploads = multer({dest:'./uploads'})\r\nimport bodyParser from \"body-parser\"\r\n\r\n\r\n\r\nstories.get(\"/\", (req, res) => {\r\n  Story.find({}, (err,stories)=>{\r\n    if(err) throw err\r\n    res.render(\"membre\",{ stories , title:\"Histoires\" })\r\n  }).populate('auteur')\r\n});\r\n\r\nstories.get(\"/creatblog\", (req, res) => {\r\n  res.render(\"creatblog\",{title:\"Writing History\"})\r\n});\r\n\r\n\r\n\r\nstories.post('/creatblog', (req, res) => {\r\n  req.body.auteur = req.user._id;\r\n  const newStory = new Story(req.body)\r\n  if (req.file) {\r\n    console.log('uploding img');\r\n    const profileimage = req.file.filename\r\n  }\r\n  else {\r\n    console.log('no img uploaded');\r\n    const profileimage = 'noimage.png'\r\n  }\r\n  newStory.save((err, story) => {\r\n    if (err) {\r\n      // res.send(err)\r\n      res.redirect('/')\r\n      // alert(\"votre requete n'à pas était enregistrer, veuillez ressayer\")\r\n      console.log(err, \"votre requete n'à pas était enregistrer, veuillez ressayer\");\r\n    } else {\r\n      res.redirect('/')\r\n      // res.send(req.body);\r\n      console.log(req.body);\r\n    }\r\n  })\r\n  // req.flash('succcess', 'vous pouvais vous co vous etes dans la BdD')\r\n  //res.redirect('/')\r\n})\r\n\r\nstories.get(\"/:id\", (req, res) => {\r\n  console.log(req.params.id);\r\n  Story.find({_id:req.params.id}, (err,story)=>{\r\n    if(err) throw err\r\n    console.log(story[0]);\r\n    console.log(story[0].name);\r\n    story=story[0]\r\n\r\n    res.render(\"histoire\",{\r\n      story,\r\n      title: story.name\r\n    })\r\n  })\r\n});\r\n\r\nstories.get('/delete/:id', function (req, res) {\r\n  const _id = req.params.id;\r\n  Story.findOneandRemove({_id}, (err)=>{\r\n    if(err) throw err\r\n    res.redirect(\"http://localhost:4567/stories\")\r\n  })\r\n});\r\n\r\n\r\nexport {stories}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/routes/story.js","import mongoose from 'mongoose'\r\nconst Schema = mongoose.Schema\r\n\r\nconst storySchema = new Schema({\r\n  name:{type:String},\r\n  ouvrage: {type: String},\r\n  type:{type:String},\r\n  auteur:{type: Schema.Types.ObjectId, ref: 'User'}\r\n})\r\n\r\nconst Story = mongoose.model('Story', storySchema)\r\n\r\nexport { Story }\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/model/story.js","import express from \"express\"\r\nconst users = express.Router()\r\nimport { User } from '../model/user'\r\nimport multer from 'multer'\r\nconst uploads = multer({dest:'./uploads'})\r\nimport passport from \"passport\"\r\nimport passportLocal from \"passport-local\"\r\n\r\nconst LocalStrategy = passportLocal.Strategy\r\n\r\npassport.use(new LocalStrategy(\r\n  function(username, password, done) {\r\n    User.findOne({ username: username }, function (err, user) {\r\n      if (err) {\r\n         return done(err); }\r\n      if (!user) {\r\n        return done(null, false); }\r\n      //if (!user.verifyPassword(password)) { return done(null, false); }\r\n      return done(null, user);\r\n    });\r\n  }\r\n));\r\n\r\nusers.get(\"/register\", (req, res) => {\r\n  res.render(\"register\",{title:\"register\"})\r\n});\r\n\r\nusers.post(\"/register\", (req, res) => {\r\n  const user = new User(req.body)\r\n  user.save((err, user) => {\r\n    if(err) throw err\r\n    res.redirect(\"/\")\r\n  })\r\n})\r\n\r\n\r\nusers.get(\"/login\", (req, res) => {\r\n  res.render(\"login\", {title:\"login\"})\r\n});\r\n\r\nusers.post('/login', passport.authenticate('local', { successRedirect: '/',\r\n                                                    failureRedirect: '/users/login' }));\r\n\r\n\r\nusers.get('/logout', function(req, res){\r\n  req.logout();\r\n  res.redirect('/');\r\n});\r\n\r\nexport {users}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/routes/user.js","module.exports = require(\"passport-local\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"passport-local\"\n// module id = 17\n// module chunks = 0"],"sourceRoot":""}